# æœ¬åœ°æ‰“åŒ…éƒ¨ç½²æŒ‡å—ï¼ˆé€šè¿‡ Gitï¼‰

## ğŸ“¦ ä¸€ã€æœ¬åœ°æ‰“åŒ…

### 1. åœ¨æœ¬åœ°æ„å»ºé¡¹ç›®

```bash
cd nuxtjs

# å®‰è£…ä¾èµ–
npm install

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

æ„å»ºå®Œæˆåä¼šç”Ÿæˆ `.output` ç›®å½•ï¼ŒåŒ…å«æ‰€æœ‰å¿…è¦çš„æ–‡ä»¶ã€‚

## ğŸ“¤ äºŒã€å‡†å¤‡ä¸Šä¼ æ–‡ä»¶

### éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶/æ–‡ä»¶å¤¹

**å¿…é¡»ä¸Šä¼ ï¼š**
1. `.output/` - **æ•´ä¸ªç›®å½•**ï¼ˆåŒ…å«æœåŠ¡å™¨ä»£ç ã€é™æ€èµ„æºã€ä»¥åŠå¿…è¦çš„ node_modulesï¼‰
2. `package.json` - ä¾èµ–å£°æ˜ï¼ˆæœåŠ¡å™¨éœ€è¦æŸ¥çœ‹ï¼‰
3. `prisma/` - æ•°æ®åº“ schema å’Œè¿ç§»æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦æ•°æ®åº“æ“ä½œï¼‰

**ä¸éœ€è¦ä¸Šä¼ ï¼š**
- `node_modules/` - .output ä¸­å·²åŒ…å«ç”Ÿäº§ä¾èµ–
- `.env` - ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆé€šè¿‡å…¶ä»–æ–¹å¼é…ç½®ï¼Œä¸è¦æäº¤åˆ° gitï¼‰
- `.nuxt/`, `.cache/` - å¼€å‘æ—¶çš„ä¸´æ—¶æ–‡ä»¶
- æºä»£ç æ–‡ä»¶ï¼ˆ.vue, .ts ç­‰ï¼‰- å·²æ‰“åŒ…åœ¨ .output ä¸­

### ä¿®æ”¹ .gitignore

ç”±äº `.output` é»˜è®¤åœ¨ `.gitignore` ä¸­ï¼Œéœ€è¦ä¸´æ—¶å…è®¸å®ƒè¢«æäº¤ï¼š

**æ–¹æ³• 1ï¼šä¿®æ”¹ .gitignoreï¼ˆæ¨èç”¨äºéƒ¨ç½²åˆ†æ”¯ï¼‰**

åœ¨ `.gitignore` ä¸­æ·»åŠ ä¾‹å¤–è§„åˆ™ï¼š

```gitignore
# å…è®¸ .output è¢«æäº¤ï¼ˆä»…ç”¨äºéƒ¨ç½²ï¼‰
!.output/
!.output/**
```

**æ–¹æ³• 2ï¼šä½¿ç”¨å¼ºåˆ¶æ·»åŠ ï¼ˆé€‚åˆä¸€æ¬¡æ€§éƒ¨ç½²ï¼‰**

```bash
git add -f .output
```

## ğŸ”§ ä¸‰ã€æäº¤åˆ° Git

```bash
# æ·»åŠ æ–‡ä»¶
git add .output package.json prisma

# æäº¤
git commit -m "chore: æ·»åŠ æ„å»ºäº§ç‰©ç”¨äºéƒ¨ç½²"

# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin main
```

## ğŸ–¥ï¸ å››ã€æœåŠ¡å™¨ä¸Šéƒ¨ç½²

### 1. æ‹‰å–ä»£ç 

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd /path/to/your/project
git pull origin main
```

### 2. å®‰è£…å¿…è¦çš„ä¾èµ–ï¼ˆä»… Prismaï¼Œå¦‚æœéœ€è¦ï¼‰

å¦‚æœæœåŠ¡å™¨ä¸Šéœ€è¦è¿è¡Œæ•°æ®åº“è¿ç§»ï¼Œéœ€è¦å®‰è£… Prisma CLIï¼š

```bash
cd nuxtjs

# åªå®‰è£… Prisma CLIï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
npm install -g prisma

# æˆ–è€…ä½¿ç”¨ npxï¼ˆä¸éœ€è¦å…¨å±€å®‰è£…ï¼‰
npx prisma migrate deploy
npx prisma generate
```

**æ³¨æ„ï¼š** `.output/server/node_modules/` ä¸­å·²ç»åŒ…å«äº†è¿è¡Œæ—¶çš„ç”Ÿäº§ä¾èµ–ï¼Œä¸éœ€è¦è¿è¡Œ `npm install`ã€‚

### 3. é…ç½®ç¯å¢ƒå˜é‡

åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»º `.env` æ–‡ä»¶ï¼ˆä¸è¦æäº¤åˆ° gitï¼‰ï¼š

```bash
cd nuxtjs
nano .env
```

```env
# æ•°æ®åº“é…ç½®
DB_HOST=your-db-host
DB_PORT=3306
DB_USER=your-db-user
DB_PASSWORD=your-db-password
DATABASE_URL=mysql://user:password@host:port/database

# OSS é…ç½®
OSS_BUCKET=your-bucket
OSS_ENDPOINT=oss-cn-hongkong.aliyuncs.com
OSS_REGION=oss-cn-hongkong
OSS_ACCESS_KEY=your-access-key
OSS_ACCESS_SECRET=your-access-secret

# JWT é…ç½®
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=7d

# Node ç¯å¢ƒ
NODE_ENV=production
PORT=3000
```

### 4. è¿è¡Œæ•°æ®åº“è¿ç§»ï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
cd nuxtjs
npx prisma migrate deploy
npx prisma generate
```

### 5. å¯åŠ¨æœåŠ¡

**ä½¿ç”¨ PM2ï¼ˆæ¨èï¼‰ï¼š**

```bash
# ç¡®ä¿å·²å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start .output/server/index.mjs --name nuxtjs-app

# æˆ–ä½¿ç”¨ ecosystem é…ç½®
pm2 start ecosystem.config.cjs
```

**ç›´æ¥è¿è¡Œï¼š**

```bash
cd nuxtjs
node .output/server/index.mjs
```

### 6. éªŒè¯æœåŠ¡

```bash
# æ£€æŸ¥ PM2 çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs nuxtjs-app

# æµ‹è¯•æœåŠ¡
curl http://localhost:3000
```

## ğŸ“ äº”ã€æ›´æ–°éƒ¨ç½²æµç¨‹

å½“éœ€è¦æ›´æ–°éƒ¨ç½²æ—¶ï¼š

### æœ¬åœ°æ“ä½œï¼š
```bash
# 1. æ›´æ–°ä»£ç å¹¶æ„å»º
git pull
npm install
npm run build

# 2. æäº¤æ„å»ºäº§ç‰©
git add .output
git commit -m "chore: æ›´æ–°æ„å»ºäº§ç‰©"
git push
```

### æœåŠ¡å™¨æ“ä½œï¼š
```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull

# 2. é‡å¯åº”ç”¨ï¼ˆä½¿ç”¨ PM2ï¼‰
pm2 restart nuxtjs-app

# æˆ–è€…åœæ­¢åé‡æ–°å¯åŠ¨
pm2 stop nuxtjs-app
pm2 start ecosystem.config.cjs
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **.output æ–‡ä»¶å¤§å°**ï¼š.output æ–‡ä»¶å¤¹å¯èƒ½æ¯”è¾ƒå¤§ï¼ˆå‡ ååˆ°å‡ ç™¾ MBï¼‰ï¼Œç¡®ä¿ git ä»“åº“å¯ä»¥æ¥å—ã€‚

2. **åˆ†æ”¯ç­–ç•¥å»ºè®®**ï¼š
   - å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„éƒ¨ç½²åˆ†æ”¯ï¼ˆå¦‚ `deploy` æˆ– `production`ï¼‰
   - åªåœ¨è¿™ä¸ªåˆ†æ”¯æäº¤ .output
   - ä¸»åˆ†æ”¯ï¼ˆmain/masterï¼‰ä¿æŒ .output åœ¨ .gitignore ä¸­

3. **æœåŠ¡å™¨ Node.js ç‰ˆæœ¬**ï¼š
   - è™½ç„¶ä¸éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šæ„å»ºï¼Œä½†ä»éœ€è¦ Node.js æ¥è¿è¡Œ
   - ç¡®ä¿æœåŠ¡å™¨ä¸Šçš„ Node.js ç‰ˆæœ¬ä¸æ„å»ºæ—¶ä½¿ç”¨çš„ç‰ˆæœ¬å…¼å®¹
   - Nuxt 3 é€šå¸¸éœ€è¦ Node.js 18+ æˆ– 20+

4. **Prisma Client**ï¼š
   - å¦‚æœä½¿ç”¨äº† Prismaï¼Œ.output/server/node_modules/ ä¸­åº”è¯¥å·²åŒ…å« @prisma/client
   - ä½†å¯èƒ½éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ `npx prisma generate` æ¥ç”Ÿæˆå®¢æˆ·ç«¯

5. **ç¯å¢ƒå˜é‡**ï¼š
   - `.env` æ–‡ä»¶ä¸è¦æäº¤åˆ° git
   - ä½¿ç”¨ `.env.example` ä½œä¸ºæ¨¡æ¿
   - åœ¨æœåŠ¡å™¨ä¸Šæ‰‹åŠ¨åˆ›å»º `.env` æ–‡ä»¶

## ğŸš€ ä¼˜åŒ–å»ºè®®

å¦‚æœä¸æƒ³æ¯æ¬¡æäº¤ .outputï¼ˆæ–‡ä»¶å¤ªå¤§ï¼‰ï¼Œå¯ä»¥è€ƒè™‘ï¼š

1. **ä½¿ç”¨ä¸“é—¨çš„éƒ¨ç½²åˆ†æ”¯**ï¼š
   ```bash
   # åˆ›å»ºéƒ¨ç½²åˆ†æ”¯
   git checkout -b deploy
   
   # å…è®¸ .output
   echo "!.output/" >> .gitignore
   
   # åªåœ¨ deploy åˆ†æ”¯æäº¤ .output
   git add .output
   git commit -m "deploy: æ„å»ºäº§ç‰©"
   git push origin deploy
   ```

2. **ä½¿ç”¨ Git LFS**ï¼ˆå¦‚æœ .output éå¸¸å¤§ï¼‰ï¼š
   ```bash
   git lfs install
   git lfs track ".output/**"
   git add .gitattributes
   ```

3. **ä½¿ç”¨ CI/CD**ï¼š
   - åœ¨ GitHub Actions / GitLab CI ä¸­è‡ªåŠ¨æ„å»º
   - æ„å»ºäº§ç‰©ä¸Šä¼ åˆ°æœåŠ¡å™¨æˆ–å¯¹è±¡å­˜å‚¨
   - ä¸åœ¨ git ä»“åº“ä¸­ä¿å­˜æ„å»ºäº§ç‰©



unzip -o æ–‡ä»¶å.zip

