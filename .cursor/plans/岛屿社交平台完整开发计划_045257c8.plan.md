---
name: 岛屿社交平台完整开发计划
overview: 从零开始搭建完整的岛屿社交平台项目，包括 UniApp APP端、Nuxt.js Web端、NestJS 后端和后台管理系统，实现10个核心页面和所有功能模块。
todos:
  - id: phase0-database-doc
    content: 第零阶段：创建数据库设计文档 - 设计完整的数据库ER图、所有数据表结构、Prisma Schema，输出 docs/数据库设计.md
    status: pending
  - id: phase0-api-doc
    content: 第零阶段：创建API接口文档 - 定义所有接口的详细规范（请求/响应/错误码），按模块分类，输出 docs/API接口文档.md
    status: pending
    dependencies:
      - phase0-database-doc
  - id: phase0-task-list
    content: 第零阶段：创建开发任务清单 - 将整个项目拆分为详细的小任务，每个任务包含上下文引用、技术要求、验收标准，输出 docs/开发任务清单.md
    status: pending
    dependencies:
      - phase0-database-doc
      - phase0-api-doc
  - id: phase1-init
    content: 第一阶段：项目基础架构搭建 - 初始化所有项目（UniApp、Nuxt.js、NestJS、后台管理），配置基础依赖和项目结构
    status: pending
    dependencies:
      - phase0-task-list
  - id: phase1-database
    content: 第一阶段：数据库设计与初始化 - 使用 Prisma 设计完整数据模型，创建数据库迁移，生成 Prisma Client
    status: pending
    dependencies:
      - phase1-init
  - id: phase1-backend-base
    content: 第一阶段：后端基础架构 - 搭建 NestJS 项目结构，实现 JWT 认证、异常处理、OSS 上传等基础模块
    status: pending
    dependencies:
      - phase1-database
  - id: phase1-frontend-base
    content: 第一阶段：前端基础架构 - 配置 UniApp 和 Nuxt.js 的基础架构（UI 库、状态管理、请求封装、路由等）
    status: pending
    dependencies:
      - phase1-init
  - id: phase1-statistics
    content: 第一阶段：数据统计 SDK 开发 - 实现统一的统计 SDK，支持页面访问和点击事件统计，实现数据上报接口
    status: pending
    dependencies:
      - phase1-backend-base
  - id: phase2-auth
    content: 第二阶段：用户系统与认证 - 实现后端用户模块（注册、登录、忘记密码）和前端登录注册页面，完成认证中间件
    status: pending
    dependencies:
      - phase1-backend-base
      - phase1-frontend-base
  - id: phase3-home
    content: 第三阶段：首页模块开发 - 实现 Page 1-3（发现页、关注页、热门岛屿页）及对应后端接口
    status: pending
    dependencies:
      - phase2-auth
  - id: phase3-island
    content: 第三阶段：岛屿模块开发 - 实现 Page 4-5（加入的岛屿页、岛屿详情页）及对应后端接口
    status: pending
    dependencies:
      - phase2-auth
  - id: phase3-notification
    content: 第三阶段：通知模块开发 - 实现 Page 6（通知页面）及对应后端接口
    status: pending
    dependencies:
      - phase2-auth
  - id: phase3-profile
    content: 第三阶段：个人中心模块开发 - 实现 Page 7-10（个人页面、申请入驻、发布弹窗、个人主页）及对应后端接口
    status: pending
    dependencies:
      - phase2-auth
  - id: phase4-social
    content: 第四阶段：社交与互动功能 - 实现内容发布、点赞评论收藏、搜索功能、关注系统
    status: pending
    dependencies:
      - phase3-home
      - phase3-island
      - phase3-profile
  - id: phase5-coin
    content: 第五阶段：金币系统与支付 - 实现金币充值消费、支付集成、交易记录管理
    status: pending
    dependencies:
      - phase4-social
  - id: phase6-admin
    content: 第六阶段：后台管理系统 - 开发完整的后台管理系统，包括用户管理、内容管理、岛屿管理、创作者管理、数据统计等模块
    status: pending
    dependencies:
      - phase5-coin
  - id: phase7-statistics
    content: 第七阶段：数据统计完善 - 完善所有统计埋点，实现数据可视化和分析报表
    status: pending
    dependencies:
      - phase6-admin
  - id: phase8-optimize
    content: 第八阶段：优化与测试 - 性能优化、功能测试、Bug 修复、测试数据准备
    status: pending
    dependencies:
      - phase7-statistics
---

# 岛屿社交平台完整开发计划

## 项目概述

基于产品构想和规划书，开发一个包含 APP（UniApp）、Web（Nuxt.js）、后端（NestJS）和后台管理系统的完整社交平台项目。

## 技术架构

- **APP端**: UniApp + uView UI + Pinia
- **Web端**: Nuxt.js 3 + Element Plus + Pinia  
- **后端**: NestJS + Prisma + MySQL + 阿里云 OSS
- **后台**: Vue 3 + Element Plus + Pinia

## 开发阶段规划

### 第零阶段：文档体系完善（前置条件）

在开始开发之前，必须先完成以下文档，为后续开发提供清晰的指导和上下文：

#### 0.1 数据库设计文档（docs/数据库设计.md）

**文档内容要求：**

- 完整的数据库 ER 图（使用 Mermaid 图表）
- 每个数据表的详细设计：
- 表名和用途说明
- 所有字段定义（字段名、类型、约束、默认值、说明）
- 索引设计
- 外键关系
- 关联关系说明
- 数据表清单：
- User（用户表）
- Island（岛屿表）
- Post（帖子表）
- Comment（评论表）
- Follow（关注表）
- IslandMember（加入岛屿表）
- Notification（通知表）
- CoinTransaction（金币交易表）
- PageView（页面访问统计表）
- ClickEvent（点击事件统计表）
- UserBehavior（用户行为统计表）
- CreatorApplication（创作者申请表）
- 其他必要的关联表
- Prisma Schema 设计说明
- 数据库初始化脚本说明

**参考文档：**

- `产品构想和规划书.md` 第五章"技术架构"中的数据库设计部分
- `产品构想和规划书.md` 第656-658行的数据表说明

#### 0.2 API接口文档（docs/API接口文档.md）

**文档内容要求：**

- 接口规范说明（请求格式、响应格式、错误码定义）
- 按模块分类的接口清单：
- **认证模块（Auth）**
    - POST /api/auth/register - 用户注册
    - POST /api/auth/login - 用户登录
    - POST /api/auth/logout - 用户登出
    - POST /api/auth/refresh - 刷新Token
    - POST /api/auth/forgot-password - 忘记密码
    - POST /api/auth/reset-password - 重置密码
- **用户模块（User）**
    - GET /api/user/profile - 获取用户信息
    - PUT /api/user/profile - 更新用户信息
    - POST /api/user/avatar - 上传头像
    - GET /api/user/:id - 获取用户主页信息
    - GET /api/user/followers - 获取粉丝列表
    - GET /api/user/followings - 获取关注列表
    - POST /api/user/follow/:id - 关注用户
    - DELETE /api/user/follow/:id - 取消关注
- **内容模块（Content）**
    - GET /api/posts/list - 获取内容列表（发现页）
    - GET /api/posts/following - 获取关注动态
    - GET /api/posts/:id - 获取内容详情
    - POST /api/posts - 发布内容
    - PUT /api/posts/:id - 更新内容
    - DELETE /api/posts/:id - 删除内容
    - POST /api/posts/:id/like - 点赞
    - DELETE /api/posts/:id/like - 取消点赞
    - POST /api/posts/:id/collect - 收藏
    - DELETE /api/posts/:id/collect - 取消收藏
- **岛屿模块（Island）**
    - GET /api/islands/list - 获取岛屿列表
    - GET /api/islands/hot - 获取热门岛屿
    - GET /api/islands/my - 获取我的岛屿
    - GET /api/islands/:id - 获取岛屿详情
    - GET /api/islands/:id/posts - 获取岛屿内容列表
    - POST /api/islands - 创建岛屿
    - POST /api/islands/:id/join - 加入岛屿
    - DELETE /api/islands/:id/leave - 退出岛屿
- **通知模块（Notification）**
    - GET /api/notifications - 获取通知列表
    - GET /api/notifications/:id - 获取通知详情
    - PUT /api/notifications/:id/read - 标记已读
    - DELETE /api/notifications - 清除所有通知
- **评论模块（Comment）**
    - GET /api/comments/:postId - 获取评论列表
    - POST /api/comments - 发表评论
    - DELETE /api/comments/:id - 删除评论
    - POST /api/comments/:id/like - 点赞评论
- **搜索模块（Search）**
    - GET /api/search/posts - 搜索内容
    - GET /api/search/users - 搜索用户
    - GET /api/search/islands - 搜索岛屿
- **金币模块（Coin）**
    - GET /api/coins/balance - 获取金币余额
    - GET /api/coins/transactions - 获取交易记录
    - POST /api/coins/recharge - 金币充值
- **创作者模块（Creator）**
    - POST /api/creator/apply - 申请入驻
    - GET /api/creator/status - 查询申请状态
- **统计模块（Statistics）**
    - POST /api/statistics/page-view - 上报页面访问
    - POST /api/statistics/click-event - 上报点击事件
    - POST /api/statistics/batch - 批量上报统计
- 每个接口的详细说明：
- 接口路径和HTTP方法
- 请求参数（Query/Body/Params）
- 响应数据结构
- 错误码说明
- 请求示例和响应示例
- 认证说明（哪些接口需要Token，哪些不需要）

**参考文档：**

- `产品构想和规划书.md` 中各个功能模块的说明
- 各页面的功能需求

#### 0.3 开发任务清单文档（docs/开发任务清单.md）

**文档内容要求：**

- 按阶段和模块拆分的详细任务清单
- 每个任务包含：
- **任务编号**：唯一标识（如 TASK-001）
- **任务名称**：简洁明确的任务描述
- **所属阶段**：第几阶段
- **所属模块**：用户/内容/岛屿/通知等
- **优先级**：P0（核心）/ P1（重要）/ P2（一般）
- **依赖任务**：依赖的其他任务编号
- **任务描述**：详细的功能需求说明
- **参考文档**：
    - 引用的产品规划书章节（如：`产品构想和规划书.md` 第33-68行）
    - 引用的设计图路径（如：`参考设计图/1.首页-发现.png`）
    - 引用的HTML参考文件（如：`参考html/Page 1.html`）
- **技术要求**：
    - 使用的技术栈
    - 代码规范要求
    - 性能要求
- **验收标准**：
    - 功能验收标准
    - 代码质量要求
    - 测试要求
- **输出物**：
    - 需要创建的文件路径
    - 需要修改的文件路径
    - 需要创建的接口说明
- 任务分组示例：
- **阶段0：文档准备**
    - TASK-000: 创建数据库设计文档
    - TASK-001: 创建API接口文档
    - TASK-002: 创建开发任务清单文档
- **阶段1：基础架构**
    - TASK-100: 初始化UniApp项目
    - TASK-101: 初始化Nuxt.js项目
    - TASK-102: 初始化NestJS后端项目
    - ...（每个任务都要详细拆分）
- **阶段2：用户系统**
    - TASK-200: 实现用户注册接口
    - TASK-201: 实现用户登录接口
    - TASK-202: 开发UniApp登录页面
    - ...（每个任务都要详细拆分）
- **阶段3：页面开发**
    - TASK-300: 开发Page 1 - 首页发现页（UniApp）
    - TASK-301: 开发Page 1 - 首页发现页（Nuxt.js）
    - TASK-302: 实现内容列表接口
    - ...（每个页面都要拆分为多个小任务）

**参考文档：**

- `产品构想和规划书.md` 整个文档
- `当前项目初始描述.md` 中的技术栈要求
- 所有设计图和HTML参考文件

#### 0.4 文档创建任务执行顺序

1. 先创建 `数据库设计.md`（因为API和任务清单都依赖数据库设计）
2. 再创建 `API接口文档.md`（基于数据库设计和功能需求）
3. 最后创建 `开发任务清单.md`（基于前两个文档，将大任务拆分为小任务）

### 第一阶段：项目基础架构搭建（Week 1-2）

#### 1.1 项目初始化

- 创建 UniApp 项目结构
- 创建 Nuxt.js 项目结构
- 创建 NestJS 后端项目结构
- 创建后台管理系统项目结构
- 配置各项目的依赖和基础配置

#### 1.2 数据库设计与初始化

- 设计完整的数据库 ER 图
- 使用 Prisma 创建数据模型
- 配置数据库连接
- 创建数据库迁移文件
- 生成 Prisma Client

#### 1.3 后端基础架构

- NestJS 项目结构搭建
- 配置环境变量管理
- 实现 JWT 认证模块
- 配置全局异常处理
- 配置跨域和请求拦截
- 实现统一响应格式
- 配置阿里云 OSS 上传模块
- 实现图片处理（Sharp）

#### 1.4 前端基础架构

**UniApp 端:**

- 配置 uView UI 组件库
- 配置 Pinia 状态管理
- 配置 axios 请求封装
- 配置路由和页面结构
- 实现统一样式变量
- 实现基础组件（按钮、输入框、卡片等）

**Nuxt.js 端:**

- 配置 Element Plus 组件库
- 配置 Pinia 状态管理
- 配置 axios/$fetch 请求封装
- 配置路由和布局
- 实现统一样式系统
- 实现基础组件

#### 1.5 数据统计 SDK 开发

- 设计统计数据结构
- 实现统计 SDK（统一接口）
- 实现页面访问统计
- 实现点击事件统计
- 实现数据上报接口（批量上报、本地缓存）

### 第二阶段：用户系统与认证（Week 3）

#### 2.1 后端用户模块

- 实现用户注册接口（手机号/邮箱）
- 实现用户登录接口（账号密码/JWT）
- 实现第三方登录（微信/QQ，可选）
- 实现忘记密码功能
- 实现用户信息管理接口
- 实现头像上传功能

#### 2.2 前端登录注册页面

**UniApp 端:**

- 登录页面
- 注册页面
- 忘记密码页面
- 集成登录状态管理

**Nuxt.js 端:**

- 登录页面（SSR 支持）
- 注册页面
- 忘记密码页面
- 集成登录状态管理

#### 2.3 认证中间件

- 实现请求拦截器（自动添加 Token）
- 实现 Token 刷新机制
- 实现登录状态持久化
- 实现跨端登录状态同步

### 第三阶段：核心页面开发（Week 4-8）

#### 3.1 首页模块（Page 1-3）

**Page 1: 首页-发现页**

- 顶部导航栏（关注/发现/热门岛屿标签切换）
- 双列瀑布流布局
- 内容卡片组件（影视/生活/话题）
- 下拉刷新和上拉加载
- 搜索功能入口
- 底部导航栏

**Page 2: 首页-关注页**

- 关注动态流（单列布局）
- 动态卡片组件
- 互动按钮（点赞、评论、收藏、分享）
- 空状态处理

**Page 3: 首页-热门岛屿页**

- 为你推荐区域（横向滚动）
- 分类筛选标签
- 岛屿列表卡片
- 加入岛屿功能

**后端接口:**

- 内容列表接口（发现页）
- 关注动态接口
- 热门岛屿接口
- 内容详情接口
- 点赞/评论/收藏接口

#### 3.2 岛屿模块（Page 4-5）

**Page 4: 岛屿-加入的岛屿页**

- 我的岛屿列表
- 筛选和排序功能
- 岛屿卡片展示
- 创建岛屿入口

**Page 5: 岛屿详情页**

- 岛屿信息展示（背景图、头像、简介）
- 岛主信息
- 岛屿内容瀑布流
- 加入岛屿功能（付费/免费）
- 底部操作栏

**后端接口:**

- 我的岛屿列表接口
- 岛屿详情接口
- 岛屿内容列表接口
- 加入岛屿接口（支付逻辑）
- 创建岛屿接口

#### 3.3 通知模块（Page 6）

**Page 6: 通知和聊天页面**

- 通知分类（系统/互动/付费）
- 通知列表展示
- 通知详情
- 清除通知功能

**后端接口:**

- 通知列表接口
- 通知详情接口
- 标记已读接口
- 清除通知接口

#### 3.4 个人中心模块（Page 7-10）

**Page 7: 个人页面**

- 个人信息展示
- 数据统计（关注/粉丝/获赞）
- 金币余额卡片
- 快捷功能区
- 功能列表

**Page 8: 申请入驻页面**

- 创作者权益展示
- 申请表单
- 资质上传
- 提交审核

**Page 9: 发布弹窗**

- 发布类型选择
- 发布个人动态入口
- 发布岛屿帖子入口

**Page 10: 个人主页**

- 用户信息展示
- 用户动态瀑布流
- 关注/取消关注功能
- 分享功能

**后端接口:**

- 个人资料接口
- 申请入驻接口
- 发布内容接口
- 用户主页接口
- 关注/取消关注接口

### 第四阶段：社交与互动功能（Week 9-10）

#### 4.1 内容发布功能

- 文字动态发布
- 图片动态发布（多图、压缩）
- 视频动态发布（压缩、预览）
- 话题讨论发布
- 岛屿帖子发布

#### 4.2 互动功能

- 点赞功能
- 评论功能（支持回复）
- 收藏功能
- 分享功能
- 举报功能

#### 4.3 搜索功能

- 内容搜索
- 用户搜索
- 岛屿搜索
- 搜索结果展示

#### 4.4 关注系统

- 关注/取消关注
- 关注列表
- 粉丝列表
- 互相关注标识

### 第五阶段：金币系统与支付（Week 11）

#### 5.1 金币系统

- 金币充值功能
- 金币消费（加入付费岛屿）
- 金币交易记录
- 金币余额管理

#### 5.2 支付集成

- 支付接口对接（微信支付/支付宝）
- 支付回调处理
- 订单管理

### 第六阶段：后台管理系统（Week 12-13）

#### 6.1 后台基础架构

- Vue 3 + Element Plus 项目搭建
- 路由配置
- 权限管理系统
- 布局组件

#### 6.2 后台功能模块

**用户管理:**

- 用户列表（搜索、筛选）
- 用户详情查看
- 用户状态管理（封禁/解封）
- 用户数据统计

**内容管理:**

- 帖子列表（搜索、筛选）
- 内容审核（通过/拒绝/删除）
- 举报处理
- 内容数据统计

**岛屿管理:**

- 岛屿列表（搜索、筛选）
- 岛屿审核
- 岛屿设置管理
- 岛屿数据统计

**创作者管理:**

- 申请列表
- 审核处理（通过/拒绝）
- 创作者信息管理
- 权益管理

**数据统计:**

- 用户数据统计（注册、活跃、留存）
- 内容数据统计（发布、互动）
- 岛屿数据统计（创建、加入）
- 收入数据统计（金币交易）
- 页面访问统计可视化
- 点击事件统计热力图
- 用户行为分析报表

**系统设置:**

- 基础设置
- 分类管理
- 权限管理
- 日志查看

### 第七阶段：数据统计完善（Week 14）

#### 7.1 统计功能完善

- 完善所有页面的统计埋点
- 实现用户行为路径追踪
- 实现转化率分析
- 实现实时统计看板

#### 7.2 统计数据分析

- 数据可视化图表
- 统计报表生成
- 数据导出功能

### 第八阶段：优化与测试（Week 15-16）

#### 8.1 性能优化

- 图片懒加载
- 列表虚拟滚动
- 接口性能优化
- 数据库查询优化
- Web 端 SSR 优化
- SEO 优化

#### 8.2 功能测试

- 单元测试编写
- 集成测试
- 用户体验测试
- Bug 修复

#### 8.3 测试数据准备

- 创建测试用户数据
- 创建测试内容数据
- 创建测试岛屿数据
- 创建测试关注关系

## 项目目录结构

```javascript
项目根目录/
├── uniapp/              # UniApp APP端
│   ├── pages/           # 页面
│   ├── components/      # 组件
│   ├── store/           # Pinia 状态管理
│   ├── utils/           # 工具函数
│   ├── api/             # API 接口
│   └── static/          # 静态资源
├── nuxtjs/              # Nuxt.js Web端
│   ├── pages/           # 页面
│   ├── components/      # 组件
│   ├── composables/    # 组合式函数
│   ├── store/           # Pinia 状态管理
│   └── server/          # 服务端逻辑
├── backend/              # NestJS 后端
│   ├── src/
│   │   ├── modules/     # 功能模块
│   │   ├── common/      # 公共模块
│   │   ├── config/      # 配置文件
│   │   └── prisma/      # Prisma 配置
│   └── prisma/          # Prisma 数据模型
├── admin/               # 后台管理系统
│   ├── src/
│   │   ├── views/       # 页面视图
│   │   ├── components/  # 组件
│   │   ├── store/       # Pinia 状态管理
│   │   └── router/      # 路由配置
└── docs/                # 项目文档
```



## 关键文件清单

### 后端核心文件

- `backend/src/main.ts` - 应用入口
- `backend/src/app.module.ts` - 根模块
- `backend/prisma/schema.prisma` - 数据模型
- `backend/src/modules/auth/` - 认证模块
- `backend/src/modules/user/` - 用户模块
- `backend/src/modules/content/` - 内容模块
- `backend/src/modules/island/` - 岛屿模块
- `backend/src/modules/statistics/` - 统计模块

### 前端核心文件

- `uniapp/pages/index/index.vue` - 首页
- `uniapp/pages/island/index.vue` - 岛屿页
- `uniapp/store/user.ts` - 用户状态
- `nuxtjs/pages/index.vue` - Web首页
- `nuxtjs/composables/useAuth.ts` - 认证组合函数

## 开发原则

1. **文档先行**: 在开始编码前，必须先完成数据库设计、API接口文档和开发任务清单
2. **任务拆分**: 每个大任务必须拆分为可执行的小任务，每个小任务包含充分的上下文引用
3. **上下文充分**: 每个任务必须引用相关文档章节、设计图路径、参考代码等
4. **模块化开发**: 每个功能模块独立开发，便于维护
5. **接口先行**: 先定义接口文档，前后端并行开发
6. **组件复用**: 提取公共组件，避免重复代码
7. **统一规范**: 代码规范、命名规范、架构规范统一
8. **迭代验证**: 每个阶段完成后进行测试验证
9. **文档同步**: 开发过程中同步更新文档

## 任务执行标准格式

每个开发任务在执行时，必须包含以下信息：

### 任务上下文引用格式

```javascript
【任务编号】任务名称

【上下文】
- 参考文档：@产品构想和规划书.md 第X-Y行
- 设计图：@参考设计图/页面名称.png
- HTML参考：@参考html/Page X.html
- API文档：@docs/API接口文档.md 第X模块
- 数据库设计：@docs/数据库设计.md 第X表
- 相关代码：@文件路径（如果存在）

【需求】
1. 具体需求1
2. 具体需求2
3. 具体需求3

【技术要求】
- 使用技术栈：xxx
- 代码规范：xxx
- 性能要求：xxx

【验收标准】
- 功能验收：xxx
- 代码质量：xxx
- 测试要求：xxx

【输出】
- 创建文件：xxx
- 修改文件：xxx
- 接口说明：xxx
```



### 任务拆分原则

1. **单一职责**: 每个任务只做一件事
2. **可测试**: 每个任务完成后可以独立测试
3. **有输出**: 每个任务必须有明确的输出物
4. **有依赖**: 明确标注任务之间的依赖关系
5. **有上下文**: 每个任务必须引用相关文档和设计资源